<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Analysing the customer experience | Data Science for Water Professionals - Create Value from Data with the R Language</title>
  <meta name="description" content="Data science course for water management professionals using the R language. This course is developed for water professionals with little to no experience in writing code to analyse data." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Analysing the customer experience | Data Science for Water Professionals - Create Value from Data with the R Language" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://lucidmanager.org/r4h2o" />
  <meta property="og:image" content="https://lucidmanager.org/r4h2o/images/r4h2o-cover.jpg" />
  <meta property="og:description" content="Data science course for water management professionals using the R language. This course is developed for water professionals with little to no experience in writing code to analyse data." />
  <meta name="github-repo" content="pprevos/r4h2o" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Analysing the customer experience | Data Science for Water Professionals - Create Value from Data with the R Language" />
  
  <meta name="twitter:description" content="Data science course for water management professionals using the R language. This course is developed for water professionals with little to no experience in writing code to analyse data." />
  <meta name="twitter:image" content="https://lucidmanager.org/r4h2o/images/r4h2o-cover.jpg" />

<meta name="author" content="Dr Peter Prevos" />


<meta name="date" content="2021-11-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="customers.html"/>
<link rel="next" href="reporting.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Water Professionals</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#case-study-approach"><i class="fa fa-check"></i><b>1.3</b> Case Study approach</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#case-study-1-water-quality-regulations"><i class="fa fa-check"></i><b>1.3.1</b> Case Study 1: Water Quality Regulations</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#case-study-2-customer-experience"><i class="fa fa-check"></i><b>1.3.2</b> Case Study 2: Customer Experience</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datascience.html"><a href="datascience.html"><i class="fa fa-check"></i><b>2</b> Principles of Water Utility Data Science</a>
<ul>
<li class="chapter" data-level="2.1" data-path="datascience.html"><a href="datascience.html#what-is-data-science"><i class="fa fa-check"></i><b>2.1</b> What is data science?</a></li>
<li class="chapter" data-level="2.2" data-path="datascience.html"><a href="datascience.html#the-elements-of-data-science"><i class="fa fa-check"></i><b>2.2</b> The Elements of Data Science</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="datascience.html"><a href="datascience.html#domain-knowledge"><i class="fa fa-check"></i><b>2.2.1</b> Domain Knowledge</a></li>
<li class="chapter" data-level="2.2.2" data-path="datascience.html"><a href="datascience.html#mathematical-knowledge"><i class="fa fa-check"></i><b>2.2.2</b> Mathematical Knowledge</a></li>
<li class="chapter" data-level="2.2.3" data-path="datascience.html"><a href="datascience.html#computer-science"><i class="fa fa-check"></i><b>2.2.3</b> Computer Science</a></li>
<li class="chapter" data-level="2.2.4" data-path="datascience.html"><a href="datascience.html#the-unicorn-data-scientist"><i class="fa fa-check"></i><b>2.2.4</b> The Unicorn Data Scientist?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="datascience.html"><a href="datascience.html#the-water-data-value-chain-the-digital-water-utility"><i class="fa fa-check"></i><b>2.3</b> The Water-Data Value Chain: The Digital Water Utility</a></li>
<li class="chapter" data-level="2.4" data-path="datascience.html"><a href="datascience.html#data-science-tools"><i class="fa fa-check"></i><b>2.4</b> Data Science Tools</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="datascience.html"><a href="datascience.html#spreadsheets"><i class="fa fa-check"></i><b>2.4.1</b> Spreadsheets</a></li>
<li class="chapter" data-level="2.4.2" data-path="datascience.html"><a href="datascience.html#business-intelligence-systems"><i class="fa fa-check"></i><b>2.4.2</b> Business Intelligence Systems</a></li>
<li class="chapter" data-level="2.4.3" data-path="datascience.html"><a href="datascience.html#data-science-code"><i class="fa fa-check"></i><b>2.4.3</b> Data science code</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="datascience.html"><a href="datascience.html#good-data-science"><i class="fa fa-check"></i><b>2.5</b> Good Data Science</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="datascience.html"><a href="datascience.html#data-science-trivium"><i class="fa fa-check"></i><b>2.5.1</b> Data Science Trivium</a></li>
<li class="chapter" data-level="2.5.2" data-path="datascience.html"><a href="datascience.html#useful-data-science"><i class="fa fa-check"></i><b>2.5.2</b> Useful Data Science</a></li>
<li class="chapter" data-level="2.5.3" data-path="datascience.html"><a href="datascience.html#reality"><i class="fa fa-check"></i><b>2.5.3</b> Reality</a></li>
<li class="chapter" data-level="2.5.4" data-path="datascience.html"><a href="datascience.html#data"><i class="fa fa-check"></i><b>2.5.4</b> Data</a></li>
<li class="chapter" data-level="2.5.5" data-path="datascience.html"><a href="datascience.html#information"><i class="fa fa-check"></i><b>2.5.5</b> Information</a></li>
<li class="chapter" data-level="2.5.6" data-path="datascience.html"><a href="datascience.html#knowledge"><i class="fa fa-check"></i><b>2.5.6</b> Knowledge</a></li>
<li class="chapter" data-level="2.5.7" data-path="datascience.html"><a href="datascience.html#feedback-loop"><i class="fa fa-check"></i><b>2.5.7</b> Feedback Loop</a></li>
<li class="chapter" data-level="2.5.8" data-path="datascience.html"><a href="datascience.html#sound-data-science"><i class="fa fa-check"></i><b>2.5.8</b> Sound Data Science</a></li>
<li class="chapter" data-level="2.5.9" data-path="datascience.html"><a href="datascience.html#aesthetic-data-science"><i class="fa fa-check"></i><b>2.5.9</b> Aesthetic Data Science</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="datascience.html"><a href="datascience.html#best-practice-data-science-with-r"><i class="fa fa-check"></i><b>2.6</b> Best-Practice Data Science with R</a></li>
<li class="chapter" data-level="2.7" data-path="datascience.html"><a href="datascience.html#further-study"><i class="fa fa-check"></i><b>2.7</b> Further Study</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>3</b> Introduction to the R Language</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basics.html"><a href="basics.html#the-r-language"><i class="fa fa-check"></i><b>3.1</b> The R Language</a></li>
<li class="chapter" data-level="3.2" data-path="basics.html"><a href="basics.html#basic-principles-of-programming"><i class="fa fa-check"></i><b>3.2</b> Basic principles of programming</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basics.html"><a href="basics.html#understanding-computer-code"><i class="fa fa-check"></i><b>3.2.1</b> Understanding computer code</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics.html"><a href="basics.html#debugging-code"><i class="fa fa-check"></i><b>3.3</b> Debugging Code</a></li>
<li class="chapter" data-level="3.4" data-path="basics.html"><a href="basics.html#using-r-and-rstudio"><i class="fa fa-check"></i><b>3.4</b> Using R and RStudio</a></li>
<li class="chapter" data-level="3.5" data-path="basics.html"><a href="basics.html#basics-of-the-r-language"><i class="fa fa-check"></i><b>3.5</b> Basics of the R language</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="basics.html"><a href="basics.html#arithmetic"><i class="fa fa-check"></i><b>3.5.1</b> Arithmetic</a></li>
<li class="chapter" data-level="3.5.2" data-path="basics.html"><a href="basics.html#variables"><i class="fa fa-check"></i><b>3.5.2</b> Variables</a></li>
<li class="chapter" data-level="3.5.3" data-path="basics.html"><a href="basics.html#vectors"><i class="fa fa-check"></i><b>3.5.3</b> Vectors</a></li>
<li class="chapter" data-level="3.5.4" data-path="basics.html"><a href="basics.html#basic-plots"><i class="fa fa-check"></i><b>3.5.4</b> Basic plots</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="basics.html"><a href="basics.html#rstudio-scripts-and-projects"><i class="fa fa-check"></i><b>3.6</b> RStudio scripts and projects</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="basics.html"><a href="basics.html#finding-help"><i class="fa fa-check"></i><b>3.6.1</b> Finding help</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="basics.html"><a href="basics.html#quiz-1-calculating-channel-flows"><i class="fa fa-check"></i><b>3.7</b> Quiz 1: Calculating channel flows</a></li>
<li class="chapter" data-level="3.8" data-path="basics.html"><a href="basics.html#further-study-1"><i class="fa fa-check"></i><b>3.8</b> Further Study</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4</b> Exploring Data with the Tidyverse Packages</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidyverse.html"><a href="tidyverse.html#r-libraries"><i class="fa fa-check"></i><b>4.1</b> R Libraries</a></li>
<li class="chapter" data-level="4.2" data-path="tidyverse.html"><a href="tidyverse.html#introducing-the-tidyverse"><i class="fa fa-check"></i><b>4.2</b> Introducing the Tidyverse</a></li>
<li class="chapter" data-level="4.3" data-path="tidyverse.html"><a href="tidyverse.html#case-study-1"><i class="fa fa-check"></i><b>4.3</b> Case Study 1</a></li>
<li class="chapter" data-level="4.4" data-path="tidyverse.html"><a href="tidyverse.html#exploring-the-case-study-data"><i class="fa fa-check"></i><b>4.4</b> Exploring the Case Study Data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="tidyverse.html"><a href="tidyverse.html#inspect-the-data"><i class="fa fa-check"></i><b>4.4.1</b> Inspect the data</a></li>
<li class="chapter" data-level="4.4.2" data-path="tidyverse.html"><a href="tidyverse.html#explore-the-data"><i class="fa fa-check"></i><b>4.4.2</b> Explore the data</a></li>
<li class="chapter" data-level="4.4.3" data-path="tidyverse.html"><a href="tidyverse.html#explore-variables"><i class="fa fa-check"></i><b>4.4.3</b> Explore variables</a></li>
<li class="chapter" data-level="4.4.4" data-path="tidyverse.html"><a href="tidyverse.html#filtering-data"><i class="fa fa-check"></i><b>4.4.4</b> Filtering data</a></li>
<li class="chapter" data-level="4.4.5" data-path="tidyverse.html"><a href="tidyverse.html#counting-results"><i class="fa fa-check"></i><b>4.4.5</b> Counting results</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="tidyverse.html"><a href="tidyverse.html#quiz-2-exploring-water-quality-data"><i class="fa fa-check"></i><b>4.5</b> Quiz 2: Exploring Water Quality Data</a></li>
<li class="chapter" data-level="4.6" data-path="tidyverse.html"><a href="tidyverse.html#further-study-2"><i class="fa fa-check"></i><b>4.6</b> Further Study</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>5</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistics.html"><a href="statistics.html#problem-statement"><i class="fa fa-check"></i><b>5.1</b> Problem Statement</a></li>
<li class="chapter" data-level="5.2" data-path="statistics.html"><a href="statistics.html#analyse-the-data"><i class="fa fa-check"></i><b>5.2</b> Analyse the Data</a></li>
<li class="chapter" data-level="5.3" data-path="statistics.html"><a href="statistics.html#calculating-percentiles"><i class="fa fa-check"></i><b>5.3</b> Calculating Percentiles</a></li>
<li class="chapter" data-level="5.4" data-path="statistics.html"><a href="statistics.html#analysing-grouped-data"><i class="fa fa-check"></i><b>5.4</b> Analysing Grouped Data</a></li>
<li class="chapter" data-level="5.5" data-path="statistics.html"><a href="statistics.html#quiz-3-analysing-water-quality-data"><i class="fa fa-check"></i><b>5.5</b> Quiz 3: Analysing Water Quality Data</a></li>
<li class="chapter" data-level="5.6" data-path="statistics.html"><a href="statistics.html#further-study-3"><i class="fa fa-check"></i><b>5.6</b> Further Study</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>6</b> Visualising Data with ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ggplot.html"><a href="ggplot.html#principles-of-visualisation"><i class="fa fa-check"></i><b>6.1</b> Principles of Visualisation</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ggplot.html"><a href="ggplot.html#the-aesthetics-of-visualising-data"><i class="fa fa-check"></i><b>6.1.1</b> The aesthetics of visualising data</a></li>
<li class="chapter" data-level="6.1.2" data-path="ggplot.html"><a href="ggplot.html#telling-stories"><i class="fa fa-check"></i><b>6.1.2</b> Telling Stories</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ggplot.html"><a href="ggplot.html#visualising-data-with-ggplot"><i class="fa fa-check"></i><b>6.2</b> Visualising data with ggplot</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ggplot.html"><a href="ggplot.html#aesthetics"><i class="fa fa-check"></i><b>6.2.1</b> Aesthetics</a></li>
<li class="chapter" data-level="6.2.2" data-path="ggplot.html"><a href="ggplot.html#geometries"><i class="fa fa-check"></i><b>6.2.2</b> Geometries</a></li>
<li class="chapter" data-level="6.2.3" data-path="ggplot.html"><a href="ggplot.html#facets"><i class="fa fa-check"></i><b>6.2.3</b> Facets</a></li>
<li class="chapter" data-level="6.2.4" data-path="ggplot.html"><a href="ggplot.html#statistics-1"><i class="fa fa-check"></i><b>6.2.4</b> Statistics</a></li>
<li class="chapter" data-level="6.2.5" data-path="ggplot.html"><a href="ggplot.html#coordinates"><i class="fa fa-check"></i><b>6.2.5</b> Coordinates</a></li>
<li class="chapter" data-level="6.2.6" data-path="ggplot.html"><a href="ggplot.html#themes"><i class="fa fa-check"></i><b>6.2.6</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ggplot.html"><a href="ggplot.html#sharing-visualisations"><i class="fa fa-check"></i><b>6.3</b> Sharing visualisations</a></li>
<li class="chapter" data-level="6.4" data-path="ggplot.html"><a href="ggplot.html#assignment"><i class="fa fa-check"></i><b>6.4</b> Assignment</a></li>
<li class="chapter" data-level="6.5" data-path="ggplot.html"><a href="ggplot.html#further-study-4"><i class="fa fa-check"></i><b>6.5</b> Further Study</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dataproducts.html"><a href="dataproducts.html"><i class="fa fa-check"></i><b>7</b> Creating Data Products</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dataproducts.html"><a href="dataproducts.html#data-science-workflow"><i class="fa fa-check"></i><b>7.1</b> Data Science Workflow</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="dataproducts.html"><a href="dataproducts.html#define"><i class="fa fa-check"></i><b>7.1.1</b> Define</a></li>
<li class="chapter" data-level="7.1.2" data-path="dataproducts.html"><a href="dataproducts.html#prepare"><i class="fa fa-check"></i><b>7.1.2</b> Prepare</a></li>
<li class="chapter" data-level="7.1.3" data-path="dataproducts.html"><a href="dataproducts.html#understand"><i class="fa fa-check"></i><b>7.1.3</b> Understand</a></li>
<li class="chapter" data-level="7.1.4" data-path="dataproducts.html"><a href="dataproducts.html#communicate"><i class="fa fa-check"></i><b>7.1.4</b> Communicate</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="dataproducts.html"><a href="dataproducts.html#reproducible-research"><i class="fa fa-check"></i><b>7.2</b> Reproducible Research</a></li>
<li class="chapter" data-level="7.3" data-path="dataproducts.html"><a href="dataproducts.html#r-markdown"><i class="fa fa-check"></i><b>7.3</b> R-Markdown</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="dataproducts.html"><a href="dataproducts.html#formatting-tables"><i class="fa fa-check"></i><b>7.3.1</b> Formatting tables</a></li>
<li class="chapter" data-level="7.3.2" data-path="dataproducts.html"><a href="dataproducts.html#presenting-numbers"><i class="fa fa-check"></i><b>7.3.2</b> Presenting numbers</a></li>
<li class="chapter" data-level="7.3.3" data-path="dataproducts.html"><a href="dataproducts.html#export-formats"><i class="fa fa-check"></i><b>7.3.3</b> Export formats</a></li>
<li class="chapter" data-level="7.3.4" data-path="dataproducts.html"><a href="dataproducts.html#sharing-results-online"><i class="fa fa-check"></i><b>7.3.4</b> Sharing results online</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="dataproducts.html"><a href="dataproducts.html#mini-hackathon"><i class="fa fa-check"></i><b>7.4</b> Mini Hackathon</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cleaning.html"><a href="cleaning.html"><i class="fa fa-check"></i><b>8</b> Cleaning Data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="cleaning.html"><a href="cleaning.html#case-study-2"><i class="fa fa-check"></i><b>8.1</b> Case Study 2</a></li>
<li class="chapter" data-level="8.2" data-path="cleaning.html"><a href="cleaning.html#cleaning-data"><i class="fa fa-check"></i><b>8.2</b> Cleaning data</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="cleaning.html"><a href="cleaning.html#load-and-explore-the-data"><i class="fa fa-check"></i><b>8.2.1</b> Load and explore the data</a></li>
<li class="chapter" data-level="8.2.2" data-path="cleaning.html"><a href="cleaning.html#remove-unwanted-responses"><i class="fa fa-check"></i><b>8.2.2</b> Remove unwanted responses</a></li>
<li class="chapter" data-level="8.2.3" data-path="cleaning.html"><a href="cleaning.html#remove-unwanted-variables"><i class="fa fa-check"></i><b>8.2.3</b> Remove unwanted variables</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="cleaning.html"><a href="cleaning.html#joining-data-frames"><i class="fa fa-check"></i><b>8.3</b> Joining data frames</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="cleaning.html"><a href="cleaning.html#writedata"><i class="fa fa-check"></i><b>8.3.1</b> Write data to disk</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="cleaning.html"><a href="cleaning.html#simplifying-code-with-data-pipes"><i class="fa fa-check"></i><b>8.4</b> Simplifying Code with Data Pipes</a></li>
<li class="chapter" data-level="8.5" data-path="cleaning.html"><a href="cleaning.html#quiz-4-cleaning-data"><i class="fa fa-check"></i><b>8.5</b> Quiz 4: Cleaning Data</a></li>
<li class="chapter" data-level="8.6" data-path="cleaning.html"><a href="cleaning.html#further-study-5"><i class="fa fa-check"></i><b>8.6</b> Further Study</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="customers.html"><a href="customers.html"><i class="fa fa-check"></i><b>9</b> Exploring the Customer Experience</a>
<ul>
<li class="chapter" data-level="9.1" data-path="customers.html"><a href="customers.html#consumer-involvement"><i class="fa fa-check"></i><b>9.1</b> Consumer Involvement</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="customers.html"><a href="customers.html#methodology"><i class="fa fa-check"></i><b>9.1.1</b> Methodology</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="customers.html"><a href="customers.html#missing-data"><i class="fa fa-check"></i><b>9.2</b> Missing Data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="customers.html"><a href="customers.html#imputation"><i class="fa fa-check"></i><b>9.2.1</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="customers.html"><a href="customers.html#preparing-the-involvement-data"><i class="fa fa-check"></i><b>9.3</b> Preparing the Involvement Data</a></li>
<li class="chapter" data-level="9.4" data-path="customers.html"><a href="customers.html#tidy-data"><i class="fa fa-check"></i><b>9.4</b> Tidy Data</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="customers.html"><a href="customers.html#explore-the-results"><i class="fa fa-check"></i><b>9.4.1</b> Explore the results</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="customers.html"><a href="customers.html#quiz-5-transforming-data"><i class="fa fa-check"></i><b>9.5</b> Quiz 5: Transforming data</a></li>
<li class="chapter" data-level="9.6" data-path="customers.html"><a href="customers.html#quiz-5-transforming-data-1"><i class="fa fa-check"></i><b>9.6</b> Quiz 5: Transforming data</a></li>
<li class="chapter" data-level="9.7" data-path="customers.html"><a href="customers.html#further-study-6"><i class="fa fa-check"></i><b>9.7</b> Further Study</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html"><i class="fa fa-check"></i><b>10</b> Analysing the customer experience</a>
<ul>
<li class="chapter" data-level="10.1" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#the-reliability-and-validity-of-surveys"><i class="fa fa-check"></i><b>10.1</b> The Reliability and Validity of Surveys</a></li>
<li class="chapter" data-level="10.2" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#correlations"><i class="fa fa-check"></i><b>10.2</b> Correlations</a></li>
<li class="chapter" data-level="10.3" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#hierarchical-clustering-to-assess-validity"><i class="fa fa-check"></i><b>10.3</b> Hierarchical Clustering to assess validity</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#pre-processing"><i class="fa fa-check"></i><b>10.3.1</b> Pre-processing</a></li>
<li class="chapter" data-level="10.3.2" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#scaling"><i class="fa fa-check"></i><b>10.3.2</b> Scaling</a></li>
<li class="chapter" data-level="10.3.3" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#distances"><i class="fa fa-check"></i><b>10.3.3</b> Distances</a></li>
<li class="chapter" data-level="10.3.4" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#clustering"><i class="fa fa-check"></i><b>10.3.4</b> Clustering</a></li>
<li class="chapter" data-level="10.3.5" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#interpreting-the-results"><i class="fa fa-check"></i><b>10.3.5</b> Interpreting the Results</a></li>
<li class="chapter" data-level="10.3.6" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#clustering-the-involvement-data"><i class="fa fa-check"></i><b>10.3.6</b> Clustering the Involvement Data</a></li>
<li class="chapter" data-level="10.3.7" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#other-techniques"><i class="fa fa-check"></i><b>10.3.7</b> Other techniques</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#reviewing-the-personal-involvement-index"><i class="fa fa-check"></i><b>10.4</b> Reviewing the Personal Involvement Index</a></li>
<li class="chapter" data-level="10.5" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#quiz"><i class="fa fa-check"></i><b>10.5</b> Quiz</a></li>
<li class="chapter" data-level="10.6" data-path="analysing-the-customer-experience.html"><a href="analysing-the-customer-experience.html#further-study-7"><i class="fa fa-check"></i><b>10.6</b> Further study</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reporting.html"><a href="reporting.html"><i class="fa fa-check"></i><b>11</b> Writing Reports</a>
<ul>
<li class="chapter" data-level="11.1" data-path="reporting.html"><a href="reporting.html#creating-documents-with-rmarkdown"><i class="fa fa-check"></i><b>11.1</b> Creating documents with RMarkdown</a></li>
<li class="chapter" data-level="11.2" data-path="reporting.html"><a href="reporting.html#survey-items"><i class="fa fa-check"></i><b>11.2</b> Survey Items</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="reporting.html"><a href="reporting.html#customer-characteristics"><i class="fa fa-check"></i><b>11.2.1</b> Customer characteristics</a></li>
<li class="chapter" data-level="11.2.2" data-path="reporting.html"><a href="reporting.html#service-quality"><i class="fa fa-check"></i><b>11.2.2</b> Service quality</a></li>
<li class="chapter" data-level="11.2.3" data-path="reporting.html"><a href="reporting.html#technical-quality"><i class="fa fa-check"></i><b>11.2.3</b> Technical Quality</a></li>
<li class="chapter" data-level="11.2.4" data-path="reporting.html"><a href="reporting.html#functional-quality-questions"><i class="fa fa-check"></i><b>11.2.4</b> Functional Quality Questions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="reporting.html"><a href="reporting.html#mini-hackathon-1"><i class="fa fa-check"></i><b>11.3</b> Mini Hackathon</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="reporting.html"><a href="reporting.html#data-cleaning"><i class="fa fa-check"></i><b>11.3.1</b> Data Cleaning</a></li>
<li class="chapter" data-level="11.3.2" data-path="reporting.html"><a href="reporting.html#data-exploration"><i class="fa fa-check"></i><b>11.3.2</b> Data Exploration</a></li>
<li class="chapter" data-level="11.3.3" data-path="reporting.html"><a href="reporting.html#data-analysis"><i class="fa fa-check"></i><b>11.3.3</b> Data Analysis</a></li>
<li class="chapter" data-level="11.3.4" data-path="reporting.html"><a href="reporting.html#write-a-report"><i class="fa fa-check"></i><b>11.3.4</b> Write a report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="close.html"><a href="close.html"><i class="fa fa-check"></i><b>12</b> In Closing</a>
<ul>
<li class="chapter" data-level="12.1" data-path="close.html"><a href="close.html#searching-for-answers"><i class="fa fa-check"></i><b>12.1</b> Searching for answers</a></li>
<li class="chapter" data-level="12.2" data-path="close.html"><a href="close.html#forums"><i class="fa fa-check"></i><b>12.2</b> Forums</a></li>
<li class="chapter" data-level="12.3" data-path="close.html"><a href="close.html#further-study-8"><i class="fa fa-check"></i><b>12.3</b> Further Study</a></li>
<li class="chapter" data-level="12.4" data-path="close.html"><a href="close.html#thanks"><i class="fa fa-check"></i><b>12.4</b> Thanks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="12.5" data-path="appendix.html"><a href="appendix.html#quiz1"><i class="fa fa-check"></i><b>12.5</b> Answers to Quiz 1</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="appendix.html"><a href="appendix.html#question-1"><i class="fa fa-check"></i><b>12.5.1</b> Question 1</a></li>
<li class="chapter" data-level="12.5.2" data-path="appendix.html"><a href="appendix.html#question-2"><i class="fa fa-check"></i><b>12.5.2</b> Question 2</a></li>
<li class="chapter" data-level="12.5.3" data-path="appendix.html"><a href="appendix.html#question-3"><i class="fa fa-check"></i><b>12.5.3</b> Question 3</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="appendix.html"><a href="appendix.html#quiz2"><i class="fa fa-check"></i><b>12.6</b> Answers to Quiz 2</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="appendix.html"><a href="appendix.html#question-1-1"><i class="fa fa-check"></i><b>12.6.1</b> Question 1</a></li>
<li class="chapter" data-level="12.6.2" data-path="appendix.html"><a href="appendix.html#question-2-1"><i class="fa fa-check"></i><b>12.6.2</b> Question 2</a></li>
<li class="chapter" data-level="12.6.3" data-path="appendix.html"><a href="appendix.html#question-3-1"><i class="fa fa-check"></i><b>12.6.3</b> Question 3</a></li>
<li class="chapter" data-level="12.6.4" data-path="appendix.html"><a href="appendix.html#question-4"><i class="fa fa-check"></i><b>12.6.4</b> Question 4</a></li>
<li class="chapter" data-level="12.6.5" data-path="appendix.html"><a href="appendix.html#question-5"><i class="fa fa-check"></i><b>12.6.5</b> Question 5</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="appendix.html"><a href="appendix.html#answers-to-quiz-3"><i class="fa fa-check"></i><b>12.7</b> Answers to Quiz 3</a></li>
<li class="chapter" data-level="12.8" data-path="appendix.html"><a href="appendix.html#answers-to-quiz-4"><i class="fa fa-check"></i><b>12.8</b> Answers to Quiz 4</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://peterprevos.com/" target="blank">Dr Peter Prevos</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Water Professionals - Create Value from Data with the R Language</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analysing-the-customer-experience" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Analysing the customer experience</h1>
<p>The code in the previous two chapters cleaned customer survey data and explored the content of the involvement construct. We will dig deeper into the involvement data to test its reliability and validity. We will write some code to reduce the number of dimensions so we can draw a conclusion about the level of involvement.</p>
<p>Water professionals often focus on the tangible aspects of water services and measure performance in cubic metres, gallons or kilolitres. The customer experience does not relate to these physical variables as it is a psychological dimension.</p>
<p>While water utilities tout their services as essential for life, only a small amount of water consumption is required to sustain life. Most water consumption meets other critical needs, such as social belonging and self-esteem. For example, our daily shower is not strictly necessary for health reasons. Anthropologically, the daily shower is a ritual that prepares us for the day. The daily shower is perhaps one of the greatest contributes to the economy because it is also a contemplative moment where we have our great ideas (figure 10.1). This qualitative aspect adds additional complexity to how we analyse this data.</p>
<div class="figure">
<img src="images/tap-water-advertisement.jpg" style="width:60.0%" alt="" />
<p class="caption">Mock tap water advertisement to emphasise the importance of intangible experiences.</p>
</div>
<p>This chapter discusses how psychographic surveys relate to consumer psychology and some techniques to analyse this type of data. The learning objectives for this chapter are:</p>
<ul>
<li>Asses the reliability and validity of customer surveys</li>
<li>Create and visualise a correlation matrix</li>
<li>Use hierarchical clustering to reduce data dimensions</li>
</ul>
<p>The data and code for this session are available in the <code>chapter_10.R</code> file in the <code>casestudy2</code> folder of your RStudio project.</p>
<div id="the-reliability-and-validity-of-surveys" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> The Reliability and Validity of Surveys</h2>
<p>As discussed in the <a href="datascience.html#datascience">first chapter</a>, data science needs to be valid and reliable. Validity in this sense means that a survey actually measures the psychological construct we seek to understand. Reliability means that the responses have an acceptable level of accuracy.</p>
<p>Measuring subjective phenomenons such as involvement and customer satisfaction requires special techniques to ensure that we can draw valid conclusions. This section introduces some principles of analysing subjective measures, which are applied in the remainder of this chapter.</p>
<p>The purpose of a survey is often to determine the respondent’s state of mind. Within the marketing context, surveys are used to measure psychological constructs such as customer satisfaction, trust, brand perception and consumer involvement.</p>
<p>Unlike physical measurements in a water treatment plant, the state of mind of a consumer cannot be measured directly. Even the latest brain scanning techniques are unable to measure how satisfied a customer is when using a product or any of the other phenomenons we might want to measure.</p>
<p>Surveys are the most common way to measure psychological constructs. The underlying assumption behind measuring a survey is that a causal relationship exists between the respondent’s state of mind and the answers they provide on the survey.</p>
<p>The state of mind of the customer is a latent variable, which means that it cannot be directly observed. We can only infer these variables by analysing manifest (observable) variables. The manifest variables in the case of a survey are the answers that respondents provide.</p>
<p>Asking a single direct question, such as “How much do you trust the water utility?” or “How involved are you with tap water?” are not suitable methods to measure latent variables. Firstly, these questions assume that the respondent and the researcher have the same understanding of what trust and involvement means. Secondly, with only one item, it is impossible to assess the reliability of the responses.</p>
<p>The <em>Personal Involvement Inventory</em> is a statistically validated psychological construct. This means that the researchers followed a formal process to assess the validity and reliability of the survey tool.</p>
<p>Figure 10.2 shows the theoretical model for the Personal Involvement Inventory and the ten questions. The ovals are latent the variables, and the squares are the manifest (measured) variables. The manifest variables are the answers to the survey questions. The straight arrows imply causality and the curved arrow indicates a correlation. This diagram thus means that involvement has cognitive and affective dimensions that correlate with each other. These two latent variables cause the respondent to answer each of the five items. The stronger the latent variable, the higher the response on the survey item.</p>
<div class="figure">
<img src="images/pii_model.png" style="width:25.0%" alt="" />
<p class="caption">Figure 10.2: Personal Involvement Inventory statistical model</p>
</div>
<p>This diagram shows how we can reduce the ten questions to one or two items. If all manifest variables within one construct correlate highly with each other, then we have reason to believe that the survey is reliable. We can also use other techniques, such factor analysis to reduce the ten survey questions to one or two dimensions.</p>
<p>Measuring latent variables is complicated because we need to account for a lot of issues. Firstly, the structure of the questionnaire and the wording of the questions can introduce <a href="https://en.wikipedia.org/wiki/Response_bias">response bias</a>. A bias is a situation where the respondent provides a response that is not causally related to the construct we like to measure. A bias introduces a systematic error in the analysis. Researchers have identified many causes of response bias. We have already seen how the survey managed inattentive customers with a trap question.</p>
</div>
<div id="correlations" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Correlations</h2>
<p>The first step to assess the reliability of survey questions is to test the intercorrelation between the items. In the case of the ten involvement questions, if the responses highly correlate with each other, then we can be more justified in reducing the ten responses to one. Following the model in Figure 10.1, we can expect <code>p01-p05</code> and <code>p06-p10</code> to be highly positively correlated.</p>
<p>The R language provides some functions to calculate correlations. Before we can do this, we need to convert the data structure from long to wide format. In the previous chapter, you saw the <code>pivot_longer()</code> function. The tidyr package also provides the <code>pivot_wider()</code> function, which achieves the reverse. Alternatively, you can, of course, start again from the raw data.</p>
<p>The <a href="https://tidyr.tidyverse.org/">tidyr</a> package documentation provides a detailed explanation. Each Tidyverse package has a pdf cheat-sheet that provides a concise overview of the functionality.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="analysing-the-customer-experience.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb138-2"><a href="analysing-the-customer-experience.html#cb138-2" aria-hidden="true" tabindex="-1"></a>pii_long <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;casestudy2/pii_long.csv&quot;</span>)</span>
<span id="cb138-3"><a href="analysing-the-customer-experience.html#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="analysing-the-customer-experience.html#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb138-5"><a href="analysing-the-customer-experience.html#cb138-5" aria-hidden="true" tabindex="-1"></a>pii_wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(pii_long, <span class="at">names_from =</span> Item, <span class="at">values_from =</span> Response)</span></code></pre></div>
<blockquote>
<p>Run this code and investigate the results. Read the package documentation to help you understand the code.</p>
</blockquote>
<p>The <code>cor()</code> function calculates the correlation between two vectors. The output of this function is a single number. We find that the correlation between <code>p01</code> and <code>p02</code> is approximately 0.65. We could do the same action for all combinations, but that would be tedious. The correlation function can also analyse a whole data frame at once. In this case, we need to remove the first column because it is not a numerical variable. The output of this code is a matrix of correlations between all combinations of <code>p01</code> to <code>p10</code>:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="analysing-the-customer-experience.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(pii_wide<span class="sc">$</span>p01, pii_wide<span class="sc">$</span>p02)</span></code></pre></div>
<pre><code>## [1] 0.658137510999538</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="analysing-the-customer-experience.html#cb141-1" aria-hidden="true" tabindex="-1"></a>c_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(pii_wide[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb141-2"><a href="analysing-the-customer-experience.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(c_matrix, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##       p01   p02   p03   p04   p05   p06   p07   p08   p09   p10
## p01  1.00  0.66 -0.45 -0.62 -0.54 -0.23  0.27  0.40  0.24  0.28
## p02  0.66  1.00 -0.49 -0.56 -0.51 -0.24  0.27  0.44  0.27  0.40
## p03 -0.45 -0.49  1.00  0.55  0.52  0.35 -0.31 -0.42 -0.32 -0.39
## p04 -0.62 -0.56  0.55  1.00  0.70  0.27 -0.24 -0.45 -0.24 -0.31
## p05 -0.54 -0.51  0.52  0.70  1.00  0.20 -0.18 -0.35 -0.13 -0.24
## p06 -0.23 -0.24  0.35  0.27  0.20  1.00 -0.58 -0.51 -0.58 -0.46
## p07  0.27  0.27 -0.31 -0.24 -0.18 -0.58  1.00  0.56  0.68  0.51
## p08  0.40  0.44 -0.42 -0.45 -0.35 -0.51  0.56  1.00  0.49  0.48
## p09  0.24  0.27 -0.32 -0.24 -0.13 -0.58  0.68  0.49  1.00  0.54
## p10  0.28  0.40 -0.39 -0.31 -0.24 -0.46  0.51  0.48  0.54  1.00</code></pre>
<p>The diagonal correlations are logically all 1.00, and all values are repeated above and below the diagonal.</p>
<p>The <code>cor()</code> function provides various ways to deal with missing data. Read the help file of this function to learn about the options. In this case, all missing data was removed previously and thus does not need to be accounted for.</p>
<p>This function provides the common Pearson correlation by default. In some specific cases, you might need to use different methods, which this function can also evaluate. The standard method for correlations works best with normal distributions.</p>
<blockquote>
<p>Read the help file for the correlation function with <code>help(cor)</code>.</p>
</blockquote>
<p>We can glance at the output and note that all correlations are positive, which is a first confirmation of the reliability of the PII data. If the questions did not all relate to an underlying latent variable, then the correlation matrix would be less uniform. A uniform correlation matrix suggests that the data possibly describes an underlying phenomenon, which in the case is a consumer’s involvement with tap water.</p>
<p>The basic R functionality also has a function to test the statistical validity of a correlation. The <code>cor.test()</code> function takes two vectors as input and provides the 95% confidence interval.</p>
<blockquote>
<p>Evaluate this code in the console and review the output.</p>
</blockquote>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="analysing-the-customer-experience.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(pii_wide<span class="sc">$</span>p01, pii_wide<span class="sc">$</span>p02)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  pii_wide$p01 and pii_wide$p02
## t = 18.27348435242, df = 437, p-value &lt; 2.220446049e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.601602969531719 0.708111605175401
## sample estimates:
##               cor 
## 0.658137510999538</code></pre>
<p>The output provides a wealth of statistical information about this correlation.</p>
<p>The <code>t</code> and <code>df</code> values relate to the significance statistics. The <code>p</code> value tells us that the relationship between these to variables is based on coincidence is very small (<span class="math inline">\(p &lt; 2.2 10^{-16}\)</span>). In social science, a value of less than 0.05 is often considered statistical significant. However, you need to be careful in interpreting this outcome as a correlation is only a starting point for analysis.</p>
<p>Correlations can be visualised with a scatter-plot with each of the variables on the x and y-axes. The <code>geom_point()</code> geometry in the ggplot package creates scatter-plots. Visualising the data from the survey this way is problematic because we only have responses between 1 and 7 and many points will be plotted on top of each other, so-called overplotting. One of the solutions to this problem is to add jitter to the data. Jitter is a small random amount f variation applied to each data point. The ggplot package uses the jitter geometry (<code>geom_jitter()</code>) to implement this technique.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="analysing-the-customer-experience.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb145-2"><a href="analysing-the-customer-experience.html#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="analysing-the-customer-experience.html#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pii_wide, <span class="fu">aes</span>(p01, p02)) <span class="sc">+</span> </span>
<span id="cb145-4"><a href="analysing-the-customer-experience.html#cb145-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb145-5"><a href="analysing-the-customer-experience.html#cb145-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Scatterplot of p01 and p02&quot;</span>) <span class="sc">+</span> </span>
<span id="cb145-6"><a href="analysing-the-customer-experience.html#cb145-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-99"></span>
<img src="r4h2o_files/figure-html/unnamed-chunk-99-1.png" alt="Scatterplot of item 1 and 2." width="672" />
<p class="caption">
Figure 10.1: Scatterplot of item 1 and 2.
</p>
</div>
<p>Creating a scatter plot for each permutation in the data would be a lot of work. Several specialised R packages provide functionality to visualise a correlation matrix. The corrplot package provides extensive functionality to visualise correlation matrices. Remember that before you can use this library, you need to install it with <code>install.packages("corrplot")</code>.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="analysing-the-customer-experience.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb146-2"><a href="analysing-the-customer-experience.html#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="analysing-the-customer-experience.html#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(c_matrix, <span class="at">type =</span> <span class="st">&quot;lower&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-100"></span>
<img src="r4h2o_files/figure-html/unnamed-chunk-100-1.png" alt="Correlation matrix for PII." width="672" />
<p class="caption">
Figure 10.2: Correlation matrix for PII.
</p>
</div>
<p>Figure 10.3 shows that the first five items correlate more strongly with each other than with the other five items, and vice versa. This is another indication that the model for PII matches what we see in this survey.</p>
<blockquote>
<p>Read the corrplot documentation and create different versions of this correlation matrix.</p>
</blockquote>
<p>However, correlations are an insufficient metric to draw conclusions about the world. A strong correlation is only an invitation to undertake further research. The old adage ‘correlation is not causation’ certainly is valid in this case.</p>
<blockquote>
<p>Correlation is not causation.</p>
</blockquote>
<p>The strong correlation between the survey items does not mean that these responses cause each other. Instead, the correlation indicates that there might be an underlying cause that causes them to correlate. This cause is the psychological construct of involvement, which is what we set out to measure.</p>
</div>
<div id="hierarchical-clustering-to-assess-validity" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Hierarchical Clustering to assess validity</h2>
<p>The correlation matrix indicates that the responses from customers are reliable as the individual items strongly relate to each other. But how do we know that these ten items point to a single latent variable? In other words, are the results of this survey valid; are we actually measuring an underlying psychological phenomenon?</p>
<p>Following the theory of latent variables, the ten measured variables should point to underlying phenomena. Several methods are available to reduce the ten survey dimensions two one or two latent variables. Best practice in psychometric analysis is factor analysis and structural equation modelling. The <a href="http://personality-project.org/r/">psych package</a> provides extensive functionality to undertake such an analysis. Structural equation modelling is a complex topic that is outside the scope of this course.</p>
<p>Another method to reduce the dimensions of a set of data is hierarchical clustering. Clustering is a method to detect patterns in data. Various methods are available to identify clusters, such as <em>k</em>-means and hierarchical clustering, which we implement in this case study.</p>
<p>The basic idea of hierarchical clustering is that the algorithm calculates the ‘distance’ between data points as if they were situated in a geometric space of <em>n</em> dimensions. The algorithm then groups the points that are closest to each other. When the algorithm has identified all clusters, it proceeds to clusters these groups. This process continues until all observations are part of the same cluster.</p>
<p>Various techniques are available to calculate distances and to determine the nearest neighbour. In this chapter, we use the default values in the R functions, which calculates the Euclidean distance between points. The video below explains the principles of this technique in more detail.</p>
<p>In machine learning, clustering techniques are often used to reduce the number of variables in a predictive model. Clustering is also a technique that we can use to segment customers by grouping them together.</p>
<p>The basic principle of cluster analysis is to group observations based on their measured features. In this case study, our observations are the ten variables, and the features are the responses provided by customers. We are looking for those items among <code>p01</code> to <code>p10</code>, that have a similar response pattern. The correlation plot in Figure 10.2 already hints to the answer to this problem.</p>
<p>Hierarchical clustering involves five steps:
1. Pre-process the data
2. Scale the data
3. Calculate the distances
4. Cluster the data
5. Review the outcome</p>
<p>The next five sections show how to undertake cluster analysis using a simple two-dimensional example before we analyse the involvement survey data. The simple example contains data from 10 customers (A–J).</p>
<p>The first data dimension in the test data is the average consumption during the week and the second dimension is daily consumption on the weekends. The data consists of random numbers with a known distribution. The code is not explained, and you can reverse-engineer it at your leisure.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="analysing-the-customer-experience.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1969</span>) <span class="co">#Always create the same pseudorandom variables</span></span>
<span id="cb147-2"><a href="analysing-the-customer-experience.html#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="analysing-the-customer-experience.html#cb147-3" aria-hidden="true" tabindex="-1"></a>customers <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb147-4"><a href="analysing-the-customer-experience.html#cb147-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weekday =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">155</span> <span class="sc">*</span> <span class="fl">2.7</span>, <span class="dv">200</span>), <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">750</span>, <span class="dv">200</span>)),</span>
<span id="cb147-5"><a href="analysing-the-customer-experience.html#cb147-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weekend =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">250</span> <span class="sc">*</span> <span class="fl">2.7</span>, <span class="dv">200</span>), <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">50</span>, <span class="dv">10</span>)))</span>
<span id="cb147-6"><a href="analysing-the-customer-experience.html#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="analysing-the-customer-experience.html#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(customers, <span class="fu">aes</span>(weekday, weekend)) <span class="sc">+</span></span>
<span id="cb147-8"><a href="analysing-the-customer-experience.html#cb147-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> id)) <span class="sc">+</span></span>
<span id="cb147-9"><a href="analysing-the-customer-experience.html#cb147-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Simulated weekday and weekend consumption&quot;</span>,</span>
<span id="cb147-10"><a href="analysing-the-customer-experience.html#cb147-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Cluster analysis example&quot;</span>,</span>
<span id="cb147-11"><a href="analysing-the-customer-experience.html#cb147-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Average weekday consumption&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Average weekend consumption&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-12"><a href="analysing-the-customer-experience.html#cb147-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>)                        </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-101"></span>
<img src="r4h2o_files/figure-html/unnamed-chunk-101-1.png" alt="Clustering example." width="672" />
<p class="caption">
Figure 10.3: Clustering example.
</p>
</div>
<blockquote>
<p>Practice your skills and create a correlation matrix of the customer water consumption table.</p>
</blockquote>
<div id="pre-processing" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Pre-processing</h3>
<p>For hierarchical clustering, the columns need to contain the features by which we want to cluster (the observations), and the rows need to hold the variable we want to cluster by.</p>
<p>The data in the example is in the format we want it to be as the rows contain the clustering variable, and the columns are the features by which we seek to cluster.</p>
</div>
<div id="scaling" class="section level3" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Scaling</h3>
<p>When the features are not measured with the same method, we first need to normalise the data. We don’t need to do so in this case because all features are in volume per day. If, for example, we try to segment customers and we have their average daily water consumption, the number of times they contact the utility, and whether they are in a hardship program, then we have three very different variables that need scaling.</p>
<p>The <code>scale()</code> function normalises data. The default setting of this function calculates the mean and standard deviation of the entire vector, then scales each element by subtracting the mean and dividing the result by the standard deviation. The output of the <code>scale()</code> function is a matrix with normalised observations.</p>
<p>A matrix in R is different from a data frame because all observations are of the same type, and you can undertake algebra with its content. A data frame can store observations of many kinds, as long as each column has the same kind of data.</p>
<p>The input for the scale function in this example are the features of the customers data frame (excluding the first column as this is an identifier).</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="analysing-the-customer-experience.html#cb148-1" aria-hidden="true" tabindex="-1"></a>customers_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(customers[, <span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
</div>
<div id="distances" class="section level3" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> Distances</h3>
<p>Hierarchical clustering requires the distance between observations. With two or three dimensions, this is fairly easy to understand. The most common method is to calculate the Euclidean distance, using the famous Pythagoras formula for two dimensions:</p>
<p><span class="math display">\[d = \sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2}\]</span></p>
<p>The output of this function is a matrix with the same size as the number of cluster observations. In the example, we are clustering ten customers, so the result is a ten by ten matrix with a ‘distance’ between each of them. However, the matrix only contains the lower triangle. Review the output of the function in the console.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="analysing-the-customer-experience.html#cb149-1" aria-hidden="true" tabindex="-1"></a>customers_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(customers)</span></code></pre></div>
<pre><code>## Warning in dist(customers): NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="analysing-the-customer-experience.html#cb151-1" aria-hidden="true" tabindex="-1"></a>customers_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(customers_scaled)</span></code></pre></div>
</div>
<div id="clustering" class="section level3" number="10.3.4">
<h3><span class="header-section-number">10.3.4</span> Clustering</h3>
<p>Now we can find the customer segments. Hierarchical clustering method iterative groups observations until all are clustered into one cluster with all observations. In the example, customers (A, D), (B, C), (F, H) and (G, J) are the evident first clusters (figure 10.2). The algorithm then looks for the next level, which consists of the clusters ((A, D), (B, C)), and ((F, H), I). The next step clusters A–E and F–J in two clusters and lastly, all customers are assigned to the supercluster.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="analysing-the-customer-experience.html#cb152-1" aria-hidden="true" tabindex="-1"></a>customer_clusters <span class="ot">&lt;-</span> <span class="fu">hclust</span>(customers_dist)</span></code></pre></div>
<p>The output of the <code>hclust()</code> function is a summary of the clustering results. When printing it in the console, you get the following result:</p>
<pre><code>## 
## Call:
## hclust(d = customers_dist)
## 
## Cluster method   : complete 
## Distance         : euclidean 
## Number of objects: 10</code></pre>
<p>The best way to view the output is to plot it, which gives a dendrogram (tree diagram). The code below uses the base plotting functionality in R and not the ggplot version we have used previously. The <code>main</code> and <code>sub</code> options provide the title and subtitle to the plot. The <code>labels</code> option adds the names to the cluster numbers.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="analysing-the-customer-experience.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(customer_clusters,</span>
<span id="cb154-2"><a href="analysing-the-customer-experience.html#cb154-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Clsutering Example&quot;</span>,</span>
<span id="cb154-3"><a href="analysing-the-customer-experience.html#cb154-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">sub =</span> <span class="st">&quot;Simulated data&quot;</span>,</span>
<span id="cb154-4"><a href="analysing-the-customer-experience.html#cb154-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> customers<span class="sc">$</span>id)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-106"></span>
<img src="r4h2o_files/figure-html/unnamed-chunk-106-1.png" alt="Dendrogram of the example data." width="672" />
<p class="caption">
Figure 10.4: Dendrogram of the example data.
</p>
</div>
<p>You can view the clusters at each level of the analysis, working your way up to one supercluster. The vertical distance in the graph relates to the distance matrix. The longer the line, the less related the customers are. Visually, both figure 10.2 and figure 10.3 suggest that we should have two clusters. In this case, we only have two features, which are easy to visualise. In reality, we often have a lot more than three features which are not easy to visualise on a two-dimensional screen.</p>
<p>You can extract more information from the clusters with the <code>cutree()</code> function. This function allows you to cut the tree at a certain level. The output is a vector of the cluster number that each customer belongs to. At the highest level (<code>k = 1</code>), all customers form part of the same cluster. At the lowest level (<code>k = 10</code>), all customers are individuals.</p>
<p>Extracting two clusters, we can assign these variables as segments to our customer table and visualise the data. Note the <code>fill = factor(segment)</code>. This option assigns a fill colour to the label. The factor function is needed to force R to assign qualitative colours instead of a variable range.</p>
<blockquote>
<p>Evaluate this function without the <code>factor()</code> function to understand the difference.</p>
</blockquote>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="analysing-the-customer-experience.html#cb155-1" aria-hidden="true" tabindex="-1"></a>customers<span class="sc">$</span>Segment <span class="ot">&lt;-</span> <span class="fu">cutree</span>(customer_clusters, <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb155-2"><a href="analysing-the-customer-experience.html#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="analysing-the-customer-experience.html#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(customers, <span class="fu">aes</span>(weekday, weekend)) <span class="sc">+</span></span>
<span id="cb155-4"><a href="analysing-the-customer-experience.html#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> id, <span class="at">fill =</span> <span class="fu">factor</span>(Segment))) <span class="sc">+</span></span>
<span id="cb155-5"><a href="analysing-the-customer-experience.html#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Simulated weekday and weekend consumption&quot;</span>,</span>
<span id="cb155-6"><a href="analysing-the-customer-experience.html#cb155-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Cluster analysis example&quot;</span>,</span>
<span id="cb155-7"><a href="analysing-the-customer-experience.html#cb155-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Average weekday consumption&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Average weekend consumption&quot;</span>,</span>
<span id="cb155-8"><a href="analysing-the-customer-experience.html#cb155-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">&quot;Segment&quot;</span>) <span class="sc">+</span></span>
<span id="cb155-9"><a href="analysing-the-customer-experience.html#cb155-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-107"></span>
<img src="r4h2o_files/figure-html/unnamed-chunk-107-1.png" alt="Clustered customer segments." width="672" />
<p class="caption">
Figure 10.5: Clustered customer segments.
</p>
</div>
<p>Two clusters are the obvious answer for this problem, but in reality, the boundary between clusters is not always this clear. Interpreting the results and selecting the ideal number of clusters is a combination of scientific insight and statistical analysis.</p>
</div>
<div id="interpreting-the-results" class="section level3" number="10.3.5">
<h3><span class="header-section-number">10.3.5</span> Interpreting the Results</h3>
<p>Clustering are intuitive but can be easily misinterpreted. You cluster any data, and you will find clusters, but that does not imply that these clusters are meaningful. Some statistical techniques exist to assess how well the chosen model fits the data, but there is no single objective criterion to determine the ideal number of clusters. The statistical methods also often don’t provide a conclusive answer.</p>
<p>How do we know the ideal number of clusters? The dendrogram helps to visually review the number of clusters. The customer data is clearly best fitted with two clusters. The vertical line of the two clusters is the longest, which means the distance between the two clusters is larger than the distance between the other clusters.</p>
<p>The two-cluster, or segment, solution, is also suitable because it is reasonably logical that residential customers use water in the weekend, while large commercial customers might use much less water.</p>
<p>The main criterion for the result of cluster analysis is that it makes sense. We strive for parsimony, which means that we want to have the lowest possible number of clusters. But having too few clusters also does not help us much in explaining the structure of the data. The main criterion is whether the cluster model explains the variability of reality.</p>
<p>The final answer depends on the purpose of the analysis, how the data was collected, and on the theoretical assumptions embedded.</p>
</div>
<div id="clustering-the-involvement-data" class="section level3" number="10.3.6">
<h3><span class="header-section-number">10.3.6</span> Clustering the Involvement Data</h3>
<p>The data from the involvement survey needs to be transformed again to make it suitable for hierarchical clustering. The observations of the PII survey are the individual customers (the rows), and the features are the ten items (the columns). In this case, our interest goes to the items themselves. We thus need to rotate or transpose the data frame. We can do this with the transpose <code>t()</code> function. This function transposes rows to columns and vice versa. The code below rotates the wide survey data, excluding the <code>survey_id</code> parameter.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="analysing-the-customer-experience.html#cb156-1" aria-hidden="true" tabindex="-1"></a>pii_trans <span class="ot">&lt;-</span> <span class="fu">t</span>(pii_wide[, <span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<p>The <code>pii_trans</code> variable can now be used as an input in the clustering process.</p>
<blockquote>
<p>Undertake hierarchical clustering for the Personal Involvement Index data. Try to write the code as one single pipe with the <code>%&gt;%</code> operator. The result should look like Figure 10.5.</p>
</blockquote>
<blockquote>
<p>Use <code>rect.hclust(pii_clusters, k = 2, border = 2:3)</code> to draw a rectangle around the two-cluster (<code>k = 2</code>) solution. The <code>border = 2:3</code> defines the colour numbers of the two rectangles.</p>
</blockquote>
<p>We can see that the largest trunk in the dendrogram is with two clusters. We can safely choose this solution because the survey was designed as a two-dimensional construct. We can also see that the cluster analysis confirms the correlation matrix. The first five and the last five items are closest related to each other.</p>
<p>This analysis means that we can reasonably sure that each of these five items measures the same underlying latent variable.</p>
</div>
<div id="other-techniques" class="section level3" number="10.3.7">
<h3><span class="header-section-number">10.3.7</span> Other techniques</h3>
<p>Hiereachical clustering is not the only technique that is available to cluster data. Another popular algorithm is <em>k</em>-means, which performs better when you analyse large sets of data.</p>
<p>This article by George Serif provides a comprehensive overview of the various <a href="https://towardsdatascience.com/the-5-clustering-algorithms-data-scientists-need-to-know-a36d136ef68">methods to cluster data</a> and their differences.</p>
</div>
</div>
<div id="reviewing-the-personal-involvement-index" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Reviewing the Personal Involvement Index</h2>
<p>Now that we have shown that the first five and the last five questions cluster into one latent variable, we can review the level of involvement with tap water reported by the customers.</p>
<p>The easiest way to do this is by adding the scores for the questions for each dimension and add a total score.</p>
<p>The code below groups the data by survey id (by customer) and calculates the new scores with the <code>mutate()</code> function. This function creates a new variable in the data frame. You can add more than one new variable within one function all, as shown below.</p>
<p>After we have these three variables, we can pivot the data around these values and ditch the individual responses.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="analysing-the-customer-experience.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb157-2"><a href="analysing-the-customer-experience.html#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="analysing-the-customer-experience.html#cb157-3" aria-hidden="true" tabindex="-1"></a>pii <span class="ot">&lt;-</span> pii_wide <span class="sc">%&gt;%</span></span>
<span id="cb157-4"><a href="analysing-the-customer-experience.html#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(survey_id) <span class="sc">%&gt;%</span></span>
<span id="cb157-5"><a href="analysing-the-customer-experience.html#cb157-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Cognitive =</span> p01 <span class="sc">+</span> p02 <span class="sc">+</span> p03 <span class="sc">+</span> p04 <span class="sc">+</span> p05,</span>
<span id="cb157-6"><a href="analysing-the-customer-experience.html#cb157-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">Affective =</span> p06 <span class="sc">+</span> p07 <span class="sc">+</span> p08 <span class="sc">+</span> p09 <span class="sc">+</span> p10,</span>
<span id="cb157-7"><a href="analysing-the-customer-experience.html#cb157-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">Involvement =</span> Cognitive <span class="sc">+</span> Affective) <span class="sc">%&gt;%</span></span>
<span id="cb157-8"><a href="analysing-the-customer-experience.html#cb157-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(Cognitive<span class="sc">:</span>Involvement, </span>
<span id="cb157-9"><a href="analysing-the-customer-experience.html#cb157-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">&quot;Dimension&quot;</span>,</span>
<span id="cb157-10"><a href="analysing-the-customer-experience.html#cb157-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">&quot;Score&quot;</span>)</span></code></pre></div>
<p>The next code snippet visualises the data with the histogram geometry. The <code>bins = 30</code> option defines the number of columns of the histogram. The <code>scales = "free_x"</code> option means that for each facet, a different x-scale can be used.</p>
<blockquote>
<p>Review this code and try different options for this visualisation. What happens when you remove or change these two additional options?</p>
</blockquote>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="analysing-the-customer-experience.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pii, <span class="fu">aes</span>(Score, <span class="at">fill =</span> Dimension)) <span class="sc">+</span> </span>
<span id="cb158-2"><a href="analysing-the-customer-experience.html#cb158-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb158-3"><a href="analysing-the-customer-experience.html#cb158-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Dimension, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">+</span> </span>
<span id="cb158-4"><a href="analysing-the-customer-experience.html#cb158-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Personal Involvement Index&quot;</span>,</span>
<span id="cb158-5"><a href="analysing-the-customer-experience.html#cb158-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Tap Water Customers in Gormsey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb158-6"><a href="analysing-the-customer-experience.html#cb158-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-110"></span>
<img src="r4h2o_files/figure-html/unnamed-chunk-110-1.png" alt="Personal Involvement Index for tap water in Gormsey." width="576" />
<p class="caption">
Figure 10.6: Personal Involvement Index for tap water in Gormsey.
</p>
</div>
<p>These results are intriguing as the level of cognitive involvement is much higher than affective involvement. Customers see water more as a necessity than as something they have a relationship with. The level of affective involvement is, however, quite high compared to other commodities. This score is perhaps an expression of the types of benefits that we obtain from using tap water. The two involvement dimensions have a different distribution. While affective involvement is more or less a normal distribution, cognitive involvement is highly positively skewed.</p>
<blockquote>
<p>How would you interpret these scores? How do you explain the significant spike at the highest level of involvement?</p>
</blockquote>
</div>
<div id="quiz" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Quiz</h2>
<p>The sixth quiz asks some questions about correlations and cluster analysis.</p>
<p>The following questions test your comprehension of some of the theory and functionality explained in this chapter. Test your answer by evaluating the code in the console.</p>
<blockquote>
<p>Load the cleaned customer survey data you created in session 8.</p>
</blockquote>
<p>? What is the correlation between the level of self-reported hardship (<code>hardship</code>) and the frequency at which they contact (<code>contact</code>) their utility?</p>
<blockquote>
<p>Remember to manage the missing variables with the <code>use</code> option in the correlation function. Check the help file for the correlation function to select the correct option.</p>
</blockquote>
<ol style="list-style-type: lower-alpha">
<li>0.483</li>
<li>NA</li>
<li>1</li>
<li>0.12</li>
</ol>
<p>? What is the likelihood that the relationship between these two variables is coincidental?</p>
<ol style="list-style-type: lower-alpha">
<li>0.05</li>
<li>Impossible to tell</li>
<li>close to 0</li>
<li>0.483</li>
</ol>
<blockquote>
<p>Isolate the variables that start with the letter <code>t</code> or <code>f</code> from the customer data. This data relates to questions about service quality. Transform the data and undertake a hierarchical cluster analysis and review the dendrogram.</p>
</blockquote>
<p>? How many latent variables would you assign these 18 variables to?</p>
<ol style="list-style-type: lower-alpha">
<li>None</li>
<li>Three</li>
<li>Four</li>
<li>Two</li>
</ol>
<p>? The variables starting with the letter t measure technical quality. Determine the total score for <code>t01</code> to <code>t05</code> for each respondent. What is the mean value of this latent construct?</p>
<blockquote>
<p>Use the <code>mutate()</code> function to add the scores for each respondent.</p>
</blockquote>
<ol style="list-style-type: lower-alpha">
<li>27.6</li>
<li>20.9</li>
<li>6.7</li>
<li>NA</li>
</ol>
<p>That is it for the sixth quiz. If you get stuck, you can find the answers in the <code>quiz_06.R</code> file in the <code>casestudy2</code> folder. You can also watch the video to see the solutions.</p>
</div>
<div id="further-study-7" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> Further study</h2>
<p>Accurate measurement of psychological constructs is a complex topic that goes beyond the scope of this course. Please note that the examples in this chapter do not constitute a thorough analysis of latent constructs. Correlations and cluster analysis are great for exploration. Structural equation modelling is best practice in psychographic analysis. If you are interested in the statistical intricacies of measuring the customer experience, then read <em>Scale Development: Theory and Applications</em> by Robert Devils (2011).</p>
<p>The <a href="reporting.html#reporting">next chapter</a> invites you to further analyse the information in the customer survey data and create a report with RMarkdown.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="customers.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reporting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pprevos/r4h2o/edit/master/10_surveys.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/pprevos/r4h2o/blob/master/10_surveys.Rmd",
"text": null
},
"download": ["r4h2o.pdf", "r4h2o.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
